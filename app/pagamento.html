<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Autopark</title>
  <link rel="stylesheet" href="../assets/pagamento.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
  <div id="sidebar" class="sidebar">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()"></a>
    <a href="index.html"><i class="fas fa-home"></i> Início</a>
    <a href="listaveiculos-cadastrados.html"><i class="fas fa-list"></i> Lista de Veículos</a>
    <a href="pesquisa.html"><i class="fas fa-search"></i> Pesquisar Veículos</a>
    <a href="pagamento.html"><i class="fas fa-credit-card"></i> Pagamento</a>
    <a href="relatorio.html"><i class="fas fa-file-alt"></i> Relatório</a>
  </div>

  <div class="container">
    <h1>Calcular Pagamento</h1>
    <div class="input-group">
      <label for="placaVeiculo">Placa do Veículo</label>
      <input id="placaVeiculo" type="text" placeholder="Placa do Veículo">
    </div>
    <div class="input-group">
      <label for="marcaModelo">Marca e Modelo</label>
      <input id="marcaModelo" type="text" placeholder="Marca e Modelo">
    </div>
    <div class="input-group">
      <label for="cor">Cor</label>
      <input id="cor" type="text" placeholder="Cor">
    </div>
    <div class="input-group">
      <label for="entradaPagamento">Entrada</label>
      <input id="entradaPagamento" type="datetime-local">
    </div>
    <div class="input-group">
      <label for="metodoPagamento">Método de Pagamento</label>
      <select id="metodoPagamento">
        <option value="dinheiro">Dinheiro</option>
        <option value="credito">Cartão de Crédito</option>
        <option value="debito">Cartão de Débito</option>
        <option value="pix">PIX</option>
      </select>
    </div>
    
    <!-- Campos para informações do cartão -->
    <div id="cartaoInfo" style="display:none;">
      <div class="input-group">
        <label for="numeroCartao">Número do Cartão</label>
        <input id="numeroCartao" type="text" placeholder="Número do Cartão">
      </div>
      <div class="input-group">
        <label for="nomeTitular">Nome do Titular</label>
        <input id="nomeTitular" type="text" placeholder="Nome do Titular">
      </div>
      <div class="input-group">
        <label for="validadeCartao">Validade</label>
        <input id="validadeCartao" type="text" placeholder="MM/AA">
      </div>
      <div class="input-group">
        <label for="cvvCartao">CVV</label>
        <input id="cvvCartao" type="text" placeholder="CVV">
      </div>
    </div>

    <button id="calcPagamentoBtn" class="button">Calcular Pagamento</button>
    <div id="valorPagamento" class="payment-value"></div>
    <button id="gerarCupomBtn" class="button" style="display:none;">Gerar Cupom</button>
    <button id="voltarBtn" class="button" onclick="window.location.href='index.html';">Voltar</button>
  </div>

  <script>
    window.onload = function() {
      function getQueryParams() {
        var params = {};
        var search = window.location.search.substring(1);
        var queries = search.split("&");

        for (var i = 0; i < queries.length; i++) {
          var pair = queries[i].split("=");
          params[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);
        }

        return params;
      }

      var params = getQueryParams();

      // Preencha os campos com os valores dos parâmetros
      if (params.marcaModelo) {
        document.getElementById('marcaModelo').value = params.marcaModelo;
      }
      if (params.placa) {
        document.getElementById('placaVeiculo').value = params.placa;
      }
      if (params.cor) {
        document.getElementById('cor').value = params.cor;
      }

      // Função para definir a hora atual no campo de entrada no horário de Brasília
      function updateDateTime() {
        var now = new Date();
        var offset = -3; // Horário de Brasília é UTC-3
        var localTime = new Date(now.getTime() + (offset * 60 * 60 * 1000));
        var isoString = localTime.toISOString().slice(0, 16); // 'YYYY-MM-DDTHH:MM'
        document.getElementById('entradaPagamento').value = isoString;
      }

      // Atualize o campo imediatamente ao carregar a página
      updateDateTime();

      // Atualize o campo a cada segundo
      setInterval(updateDateTime, 1000);
    };
  </script>
  <script src="../js/pagamento.js"></script>
</body>
</html>
